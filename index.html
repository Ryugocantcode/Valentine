<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catch the Falling Hearts</title>
<style>
body {
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#ffe4e6;
  font-family:system-ui;
  overflow:hidden;
  transition: background 0.5s;
}
.card {
  background:#fff;
  padding:24px;
  border-radius:20px;
  text-align:center;
  box-shadow:0 20px 40px rgba(0,0,0,.15);
  width:90%;
  max-width:360px;
  position:relative;
  z-index:1;
  transition: transform 0.3s;
}
#gameCanvas {
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  z-index:0;
}
.hidden { display:none; }
button {
  padding:12px 20px;
  border-radius:999px;
  border:none;
  font-size:16px;
  margin-top:10px;
  transition: transform 0.3s;
}
#yes { background:#22c55e; color:#fff; }
#no { background:#ef4444; color:#fff; }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<!-- Catch Hearts Phase -->
<div class="card" id="game">
  <h2>Catch the Hearts ðŸ’—</h2>
  <p>Tap hearts to catch at least 8</p>
  <p id="count">0 / 8</p>
</div>

<!-- Continue after winning -->
<div class="card hidden" id="continueCard">
  <h2>Congratulations!! ðŸŽ‰</h2>
  <button id="continueBtn">Continue</button>
</div>

<!-- Valentine question -->
<div class="card hidden" id="question">
  <h2>Will you be my Valentine? ðŸ’–</h2>
  <button id="yes">Yes</button>
  <button id="no">No</button>
  <div id="result" class="hidden">
    <p>Yay! ðŸ’˜</p>
    <img src="hug-love.gif" style="width:100%;max-width:400px">
  </div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let hearts = [];
let caught = 0;
const target = 8;
let gamePhase = "catching"; // catching, valentine, done
let cryingMode = false;

// Create a heart/emoji object
function createHeart() {
  const size = 50;
  let emoji = "ðŸ’—";
  if(gamePhase === "done") emoji = "ðŸŒ¹";
  if(cryingMode) emoji = "ðŸ˜¢";

  hearts.push({
    x: Math.random()*(canvas.width-size),
    y: -size,
    size: size,
    speed: 2 + Math.random()*3,
    type: emoji
  });
}

// Draw hearts/emojis
function drawHearts() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  hearts.forEach(h => {
    ctx.font = h.size + "px sans-serif";
    ctx.fillText(h.type, h.x, h.y + h.size);
  });
}

// Update hearts position
function updateHearts() {
  hearts.forEach(h => { h.y += h.speed; });
  hearts = hearts.filter(h => h.y < canvas.height + 50);
}

// Spawn hearts periodically
setInterval(createHeart, 700);

// Game loop
function gameLoop() {
  drawHearts();
  updateHearts();
  requestAnimationFrame(gameLoop);
}
gameLoop();

// Handle tap/click to catch hearts
canvas.addEventListener('touchstart', catchHeart);
canvas.addEventListener('click', catchHeart);

function catchHeart(e) {
  const touch = e.touches ? e.touches[0] : e;
  const x = touch.clientX;
  const y = touch.clientY;

  hearts.forEach((h, i) => {
    if(x > h.x && x < h.x + h.size && y > h.y && y < h.y + h.size){
      if(gamePhase === "catching"){
        caught++;
        document.getElementById('count').textContent = caught + " / " + target;
        hearts.splice(i,1);
        if(caught >= target){
          document.getElementById('game').classList.add('hidden');
          document.getElementById('continueCard').classList.remove('hidden');
          gamePhase = "valentine";
        }
      } else {
        hearts.splice(i,1); // remove without counting
      }
    }
  });
}

// Continue button
document.getElementById('continueBtn').onclick = () => {
  document.getElementById('continueCard').classList.add('hidden');
  document.getElementById('question').classList.remove('hidden');
}

// Yes button
const yesBtn = document.getElementById('yes');
document.getElementById('yes').onclick = () => {
  gamePhase = "done";
  cryingMode = false;
  document.getElementById('question').classList.add('hidden');
  document.getElementById('result').classList.remove('hidden');
}

// No button
const noBtn = document.getElementById('no');
noBtn.addEventListener('click', () => {
  // Change background to gloomy
  document.body.style.background = "linear-gradient(to bottom, #2c3e50, #34495e, #7f8c8d)";
  
  // Enlarge Yes temporarily
  yesBtn.style.transform = "scale(1.3)";
  setTimeout(()=> yesBtn.style.transform = "", 500);

  // Shake No button repeatedly
  let shakes = 0;
  const maxShakes = 12;
  const shakeInterval = setInterval(() => {
    const dx = Math.random()*60-30;
    const dy = Math.random()*60-30;
    const rotate = Math.random()*30-15;
    noBtn.style.transform = `translate(${dx}px, ${dy}px) rotate(${rotate}deg)`;
    shakes++;
    if(shakes > maxShakes){
      clearInterval(shakeInterval);
      noBtn.style.transform = '';
    }
  }, 80);

  // Switch hearts to crying emojis
  cryingMode = true;
});

// Resize canvas
window.addEventListener('resize', ()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>

</body>
</html>
